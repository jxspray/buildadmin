import{D as K,_ as O}from"./darkSwitch-ad1c6f1f.js";import{i as W,h as F,q as h,X as j,o as a,k as E,Y as P,Z as V,z as n,_ as $,O as l,P as s,W as b,V as x,U as f,p,$ as R,N as X,a0 as Y,r as Q,F as Z,m as w,n as ee,a1 as ne,a2 as te}from"./vue-69ad5a16.js";import{d as ae,r as oe,b as G,u as B,a as T,c as se,s as re,_ as A,e as le,f as ie,g as ce}from"./index-32d6febb.js";import{h as ue,o as H}from"./router-b77da531.js";import{t as de}from"./useDark-4e217d35.js";const me="/api/index/";function _e(g,C){ae(()=>{if(oe.currentRoute.value.meta.initialize===!1)return;const m=G(),o=B();if(!m.isLogin()&&o.initialize||m.isLogin()&&o.userInitialize)return;const u=T();se({url:me+"index",method:"get",params:{requiredLogin:C?1:0}}).then(r=>{re(r.data.site.siteName),ue(r.data.rules,r.data.menus),o.dataFill(r.data.site),u.setStatus(r.data.openMemberCenter),W(r.data.userInfo)||(r.data.userInfo.refresh_token=m.getToken("refresh"),m.dataFill(r.data.userInfo),o.setUserInitialize(!0)),r.data.openMemberCenter||u.setLayoutMode("Disable"),o.setInitialize(!0),typeof g=="function"&&g(r)})},200)()}const pe=F({__name:"menuSub",props:{menus:{default:()=>[]},showIcon:{type:Boolean,default:!1}},setup(g){const C=g,m=o=>{var u;o.path=="/"||((u=o.meta)==null?void 0:u.type)=="menu_dir"||H(o)};return(o,u)=>{const r=h("Icon"),i=h("el-sub-menu"),v=h("el-menu-item"),y=j("blur");return a(!0),E(V,null,P(C.menus,(_,z)=>{var S,M;return a(),E(V,{key:z},[n(W)(_.children)?$((a(),l(v,{key:1,onClick:c=>n(H)(_),index:"column-"+((M=_.meta)==null?void 0:M.id),class:R(_.name.replace(/[\/]/g,"-"))},{title:s(()=>{var c;return[x(f((c=_.meta)==null?void 0:c.title),1)]}),default:s(()=>{var c;return[o.showIcon?(a(),l(r,{key:0,name:(c=_.meta)==null?void 0:c.icon,color:"var(--el-text-color-primary)"},null,8,["name"])):b("",!0)]}),_:2},1032,["onClick","index","class"])),[[y]]):$((a(),l(i,{key:0,onClick:c=>m(_),index:`column-${(S=_.meta)==null?void 0:S.id}`},{title:s(()=>{var c,e;return[o.showIcon?(a(),l(r,{key:0,name:(c=_.meta)==null?void 0:c.icon,color:"var(--el-text-color-primary)"},null,8,["name"])):b("",!0),x(" "+f((e=_.meta)==null?void 0:e.title),1)]}),default:s(()=>[p(D,{menus:_.children,"show-icon":o.showIcon},null,8,["menus","show-icon"])]),_:2},1032,["onClick","index"])),[[y]])],64)}),128)}}});const D=A(pe,[["__scopeId","data-v-0badd86c"]]),fe={class:"header-user-box"},he=["src"],ve=F({__name:"menu",props:{showIcon:{type:Boolean,default:!1}},setup(g){const C=g,m=X(),o=Y(),u=le(),r=G(),i=B(),v=T(),y=Q({activeMenu:""}),_=e=>{var t,k;for(const d in v.state.navUserMenus)if(v.state.navUserMenus[d].path==e.path||v.state.navUserMenus[d].name==e.name)return(t=v.state.navUserMenus[d].meta)==null?void 0:t.id;for(const d in i.headNav)if(i.headNav[d].path==e.path||i.headNav[d].name==e.name)return(k=i.headNav[d].meta)==null?void 0:k.id},z=e=>{if(e.path=="/")return y.activeMenu="index";const t=_(e);t?y.activeMenu="column-"+t:e.path.startsWith("/user")&&(y.activeMenu="user")};z(m);const S=e=>{if(M(i.headNav,e)||M(v.state.navUserMenus,e)){const t=y.activeMenu;y.activeMenu="",ee(()=>{y.activeMenu=t})}},M=(e,t)=>t.indexOf("language-switch")===0||t=="theme-switch"?!0:c(e,t),c=(e,t)=>{var k,d,L;for(const U in e){if(`column-${(k=e[U].meta)==null?void 0:k.id}`==t)return((d=e[U].meta)==null?void 0:d.menu_type)=="link";if((L=e[U].children)!=null&&L.length)return c(e[U].children,t)}return!1};return Z(()=>m.path,()=>{z(m)}),(e,t)=>{const k=h("Icon"),d=h("el-menu-item"),L=h("el-sub-menu"),U=h("el-menu"),N=j("blur");return a(),l(U,{"default-active":y.activeMenu,onSelect:S},{default:s(()=>[$((a(),l(d,{onClick:t[0]||(t[0]=I=>n(o).push({name:"/"})),index:"index"},{title:s(()=>[x(f(e.$t("Home")),1)]),default:s(()=>[C.showIcon?(a(),l(k,{key:0,name:"fa fa-home",color:"var(--el-text-color-primary)"})):b("",!0)]),_:1})),[[N]]),p(D,{menus:n(i).headNav,"show-icon":e.showIcon},null,8,["menus","show-icon"]),n(v).state.open?(a(),E(V,{key:0},[n(r).isLogin()?$((a(),l(L,{key:0,onClick:t[3]||(t[3]=I=>e.$attrs.mode=="vertical"?"":n(o).push({name:"user"})),index:"user-box"},{title:s(()=>[w("div",fe,[w("img",{class:R(["header-user-avatar",e.$attrs.mode=="vertical"?"icon-header-user-avatar":""]),src:n(ie)(n(r).avatar?n(r).avatar:"/static/images/avatar.png"),alt:""},null,10,he),x(" "+f(n(r).nickname),1)])]),default:s(()=>[$((a(),l(d,{onClick:t[1]||(t[1]=I=>n(o).push({name:"user"})),index:"user"},{default:s(()=>[e.showIcon?(a(),l(k,{key:0,name:"fa fa-user-circle",color:"var(--el-text-color-primary)"})):b("",!0),x(" "+f(e.$t("Member Center")),1)]),_:1})),[[N]]),p(D,{menus:n(v).state.navUserMenus,"show-icon":e.showIcon},null,8,["menus","show-icon"]),p(D,{menus:n(v).state.viewRoutes,"show-icon":e.showIcon},null,8,["menus","show-icon"]),$((a(),l(d,{onClick:t[2]||(t[2]=I=>n(r).logout()),index:"user-logout"},{default:s(()=>[e.showIcon?(a(),l(k,{key:0,name:"fa fa-sign-out",color:"var(--el-text-color-primary)"})):b("",!0),x(" "+f(e.$t("Logout login")),1)]),_:1})),[[N]])]),_:1})),[[N]]):$((a(),l(d,{key:1,onClick:t[4]||(t[4]=I=>n(o).push({name:"user"})),index:"user"},{default:s(()=>[e.showIcon?(a(),l(k,{key:0,name:"fa fa-user-circle",color:"var(--el-text-color-primary)"})):b("",!0),x(" "+f(e.$t("Member Center")),1)]),_:1})),[[N]]),$((a(),l(L,{index:"language-switch",class:"language-switch"},{title:s(()=>[e.showIcon?(a(),l(k,{key:0,name:"local-lang",color:"var(--el-text-color-primary)"})):b("",!0),x(" "+f(e.$t("Language")),1)]),default:s(()=>[(a(!0),E(V,null,P(n(u).lang.langArray,I=>(a(),l(d,{onClick:$e=>n(ce)(I.name),key:I.name,index:"language-switch-"+I.value,class:"language-switch"},{default:s(()=>[e.showIcon?(a(),l(k,{key:0,name:"fa fa-circle-o",color:"var(--el-text-color-primary)"})):b("",!0),x(" "+f(I.value),1)]),_:2},1032,["onClick","index"]))),128))]),_:1})),[[N]]),p(d,{index:"theme-switch",class:R(["theme-switch",e.$attrs.mode+"-theme-switch"])},{default:s(()=>[p(K,{onClick:t[5]||(t[5]=I=>n(de)())})]),_:1},8,["class"])],64)):b("",!0)]),_:1},8,["default-active"])}}});const q=A(ve,[["__scopeId","data-v-1bc2cccf"]]),J=g=>(ne("data-v-d2397cc9"),g=g(),te(),g),ge=J(()=>w("img",{src:O},null,-1)),ye={class:"site-name"},ke={class:"header-row"},we=J(()=>w("img",{src:O},null,-1)),Ce={class:"site-name"},Ie=F({__name:"header",setup(g){const C=X(),m=Y(),o=B(),u=T();return Z(()=>C.path,()=>{u.toggleMenuExpand(!1)},{immediate:!0}),_e(),(r,i)=>{const v=h("Icon"),y=h("el-scrollbar"),_=h("el-col"),z=h("el-row"),S=h("el-drawer"),M=h("el-header");return a(),l(M,{class:"header"},{default:s(()=>[p(z,{justify:"center"},{default:s(()=>[p(_,{class:"header-row",xs:24,sm:24,md:16},{default:s(()=>[w("div",{onClick:i[0]||(i[0]=c=>n(m).push({name:"/"})),class:"header-logo"},[ge,w("span",ye,f(n(o).siteName),1)]),n(u).state.menuExpand?b("",!0):(a(),E("div",{key:0,onClick:i[1]||(i[1]=c=>n(u).toggleMenuExpand(!0)),class:"user-menus-expand hidden-md-and-up"},[p(v,{name:"fa fa-indent",color:"var(--el-color-primary)",size:"20"})])),p(y,{class:"hidden-sm-and-down"},{default:s(()=>[p(q,{class:"frontend-header-menu",ellipsis:!1,mode:"horizontal"})]),_:1})]),_:1})]),_:1}),p(S,{class:"ba-aside-drawer","append-to-body":!0,modelValue:n(u).state.menuExpand,"onUpdate:modelValue":i[4]||(i[4]=c=>n(u).state.menuExpand=c),"with-header":!1,direction:"ltr",size:"40%"},{default:s(()=>[w("div",ke,[w("div",{onClick:i[2]||(i[2]=c=>n(m).push({name:"/"})),class:"header-logo"},[we,w("span",Ce,f(n(o).siteName),1)]),w("div",{onClick:i[3]||(i[3]=c=>n(u).toggleMenuExpand(!1)),class:"user-menus-expand hidden-md-and-up"},[p(v,{name:"fa fa-dedent",color:"var(--el-color-primary)",size:"20"})])]),p(q,{"show-icon":!0,mode:"vertical"})]),_:1},8,["modelValue"])]),_:1})}}});const Le=A(Ie,[["__scopeId","data-v-d2397cc9"]]),be={href:"http://beian.miit.gov.cn/"},xe=F({__name:"footer",setup(g){const C=B();return(m,o)=>{const u=h("el-footer");return a(),l(u,{class:"footer"},{default:s(()=>[w("div",null,[x(" Copyright @ 2020~2022 "+f(n(C).siteName)+" "+f(m.$t("Copyright"))+" ",1),w("a",be,f(n(C).recordNumber),1)])]),_:1})}}});const Ee=A(xe,[["__scopeId","data-v-5dadaf49"]]);export{Ee as F,Le as H,_e as i};
