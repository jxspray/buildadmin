import{a as c,s as C,d as te,C as N,y as T,o as ie,$ as ne,e as a,b as r,u as t,f as se,r as d,v as S,Q as m,a4 as W,c as v,R as p,S as y,W as de}from"./vue-9a46e809.js";import{H as ue,F as me}from"./footer-a4272647.js";import{h as ce,e as fe,a as pe,t as B,q as ge,v as be,w as ve,x as M,y as E}from"./common-535f3731.js";import{u as _e}from"./memberCenter-cf863e27.js";import{u as K}from"./random-1d7fa280.js";import{a as we}from"./index-ae07247d.js";import{b as f,v as ye}from"./validate-61c16ed0.js";import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";import"./useDark-1dd13716.js";import"./router-7e79b862.js";function Ve(){return new Promise(R=>R(!1))}const he={},Ce={class:"login-footer-buried-point"};function ke(R,x){return c(),C("div",Ce)}const Pe=A(he,[["render",ke]]),Fe={class:"login"},Re={key:0,class:"login-box"},xe={class:"login-title"},ze=["src"],Te={key:5,class:"form-footer"},Se={class:"retrieve-password-form"},Le=te({__name:"login",setup(R){let x;const{t:l}=we(),H=se(),j=de(),Q=ce(),G=fe(),J=_e(),V=N(),k=N(),e=T({form:{tab:"login",email:"",mobile:"",username:"",password:"",captcha:"",keep:!1,captchaId:K(),registerType:"email"},formLoading:!1,showCaptcha:!1,showRetrievePasswordDialog:!1,retrievePasswordForm:{type:"email",account:"",captcha:"",password:""},dialogWidth:36,accountVerificationType:[],codeSendCountdown:0,submitRetrieveLoading:!1,sendCaptchaLoading:!1}),O=T({email:[f({name:"required",title:l("user.login.email")}),f({name:"email",title:l("user.login.email")})],username:[f({name:"required",title:l("user.login.User name")}),{validator:(n,o,s)=>{if(e.form.tab=="register")return ye(n,o,s);s()},trigger:"blur"}],password:[f({name:"required",title:l("user.login.password")}),f({name:"password"})],mobile:[f({name:"required",title:l("user.login.mobile")}),f({name:"mobile"})],captcha:[f({name:"required",title:l("user.login.Verification Code")})]}),X=T({account:[f({name:"required",title:l("user.login.Account name")})],captcha:[f({name:"required",title:l("user.login.Verification Code")})],password:[f({name:"required",title:l("user.login.password")}),f({name:"password"})]}),L=()=>{let n=document.documentElement.clientWidth,o=36;n<=790?o=92:n<=910?o=56:n<=1260&&(o=46),e.dialogWidth=o},P=()=>{e.form.captcha="",e.form.captchaId=K()},U=(n=void 0)=>{n.validate(o=>{o?(e.formLoading=!0,B("post",e.form).then(s=>{e.formLoading=!1,Q.dataFill(s.data.userInfo),j.push({path:s.data.routePath})}).catch(()=>{e.formLoading=!1,P()})):P()})},$=(n=void 0)=>{n.validate(o=>{o&&(e.submitRetrieveLoading=!0,be(e.retrievePasswordForm).then(s=>{e.submitRetrieveLoading=!1,s.code==1&&(e.showRetrievePasswordDialog=!1,P(),z(),ve(n))}).catch(()=>{e.submitRetrieveLoading=!1}))})},Y=(n=void 0)=>{e.codeSendCountdown>0||n.validateField([e.form.registerType,"username","password"]).then(o=>{o&&(e.sendCaptchaLoading=!0,(e.form.registerType=="email"?M:E)(e.form[e.form.registerType],"user_register").then(h=>{h.code==1&&q(60)}).finally(()=>{e.sendCaptchaLoading=!1}))})},Z=(n=void 0)=>{e.codeSendCountdown>0||n.validateField("account").then(o=>{o&&(e.sendCaptchaLoading=!0,(e.retrievePasswordForm.type=="email"?M:E)(e.retrievePasswordForm.account,"user_retrieve_pwd").then(h=>{h.code==1&&q(60)}).finally(()=>{e.sendCaptchaLoading=!1}))})},I=(n=void 0,o)=>{e.form.tab=o,o=="register"&&(e.form.username=""),n&&n.clearValidate()},q=n=>{e.codeSendCountdown=n,x=setInterval(()=>{e.codeSendCountdown--,e.codeSendCountdown<=0&&z()},1e3)},z=()=>{e.codeSendCountdown=0,clearInterval(x)};return ie(async()=>{await Ve()||(L(),pe(window,"resize",L),B("get").then(n=>{e.accountVerificationType=n.data.accountVerificationType,e.retrievePasswordForm.type=n.data.accountVerificationType.length>0?n.data.accountVerificationType[0]:""}),H.query.type=="register"&&(e.form.tab="register"))}),ne(()=>{e.codeSendCountdown=0,z()}),(n,o)=>{const s=d("el-radio"),h=d("el-radio-group"),u=d("el-form-item"),g=d("Icon"),b=d("el-input"),_=d("el-col"),F=d("el-row"),w=d("el-button"),ee=d("el-checkbox"),D=d("el-form"),oe=d("el-alert"),ae=d("el-main"),le=d("el-container"),re=d("el-dialog");return c(),C("div",Fe,[a(le,{class:"is-vertical"},{default:r(()=>[a(ue),a(ae,{class:"frontend-footer-brother"},{default:r(()=>[a(F,{justify:"center"},{default:r(()=>[a(_,{span:16,xs:24},{default:r(()=>[t(J).state.open?(c(),C("div",Re,[S("div",xe,m(t(l)("user.login."+e.form.tab)+t(l)("user.login.reach")+t(G).siteName),1),a(D,{ref_key:"formRef",ref:V,onKeyup:o[13]||(o[13]=W(i=>U(V.value),["enter"])),rules:O,model:e.form},{default:r(()=>[e.form.tab=="register"?(c(),v(u,{key:0},{default:r(()=>[a(h,{size:"large",modelValue:e.form.registerType,"onUpdate:modelValue":o[0]||(o[0]=i=>e.form.registerType=i)},{default:r(()=>[a(s,{class:"register-verification-radio",label:"email",disabled:!e.accountVerificationType.includes("email"),border:""},{default:r(()=>[p(m(t(l)("user.login.Via email")+t(l)("user.login.register")),1)]),_:1},8,["disabled"]),a(s,{class:"register-verification-radio",label:"mobile",disabled:!e.accountVerificationType.includes("mobile"),border:""},{default:r(()=>[p(m(t(l)("user.login.Via mobile number")+t(l)("user.login.register")),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1})):y("",!0),a(u,{prop:"username"},{default:r(()=>[a(b,{modelValue:e.form.username,"onUpdate:modelValue":o[1]||(o[1]=i=>e.form.username=i),placeholder:e.form.tab=="register"?t(l)("Please input field",{field:t(l)("user.login.User name")}):t(l)("Please input field",{field:t(l)("user.login.account")}),clearable:!0,size:"large"},{prefix:r(()=>[a(g,{name:"fa fa-user",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1}),a(u,{prop:"password"},{default:r(()=>[a(b,{modelValue:e.form.password,"onUpdate:modelValue":o[2]||(o[2]=i=>e.form.password=i),placeholder:t(l)("Please input field",{field:t(l)("user.login.password")}),type:"password","show-password":"",size:"large"},{prefix:r(()=>[a(g,{name:"fa fa-unlock-alt",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1}),e.form.tab=="login"?(c(),v(u,{key:1,prop:"captcha"},{default:r(()=>[a(F,{class:"w100"},{default:r(()=>[a(_,{span:16},{default:r(()=>[a(b,{modelValue:e.form.captcha,"onUpdate:modelValue":o[3]||(o[3]=i=>e.form.captcha=i),clearable:"",autocomplete:"off",placeholder:t(l)("Please input field",{field:t(l)("user.login.Verification Code")}),size:"large"},{prefix:r(()=>[a(g,{name:"fa fa-ellipsis-h",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1}),a(_,{class:"captcha-box",span:8},{default:r(()=>[S("img",{onClick:P,class:"captcha-img",src:t(ge)()+"&id="+e.form.captchaId,alt:""},null,8,ze)]),_:1})]),_:1})]),_:1})):y("",!0),e.form.tab=="register"&&e.form.registerType=="mobile"?(c(),v(u,{key:2,prop:"mobile"},{default:r(()=>[a(b,{modelValue:e.form.mobile,"onUpdate:modelValue":o[4]||(o[4]=i=>e.form.mobile=i),placeholder:t(l)("Please input field",{field:t(l)("user.login.mobile")}),clearable:!0,size:"large"},{prefix:r(()=>[a(g,{name:"fa fa-tablet",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1})):y("",!0),e.form.tab=="register"&&e.form.registerType=="email"?(c(),v(u,{key:3,prop:"email"},{default:r(()=>[a(b,{modelValue:e.form.email,"onUpdate:modelValue":o[5]||(o[5]=i=>e.form.email=i),placeholder:t(l)("Please input field",{field:t(l)("user.login.email")}),clearable:!0,size:"large"},{prefix:r(()=>[a(g,{name:"fa fa-envelope",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1})):y("",!0),e.form.tab=="register"?(c(),v(u,{key:4,prop:"captcha"},{default:r(()=>[a(F,{class:"w100"},{default:r(()=>[a(_,{span:16},{default:r(()=>[a(b,{size:"large",modelValue:e.form.captcha,"onUpdate:modelValue":o[6]||(o[6]=i=>e.form.captcha=i),placeholder:t(l)("Please input field",{field:t(l)("user.login.Verification Code")}),autocomplete:"off"},{prefix:r(()=>[a(g,{name:"fa fa-ellipsis-h",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1}),a(_,{class:"captcha-box",span:8},{default:r(()=>[a(w,{size:"large",onClick:o[7]||(o[7]=i=>Y(V.value)),loading:e.sendCaptchaLoading,disabled:!(e.codeSendCountdown<=0),type:"primary"},{default:r(()=>[p(m(e.codeSendCountdown<=0?t(l)("user.login.send"):e.codeSendCountdown+t(l)("user.login.seconds")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})):y("",!0),e.form.tab!="register"?(c(),C("div",Te,[a(ee,{modelValue:e.form.keep,"onUpdate:modelValue":o[8]||(o[8]=i=>e.form.keep=i),label:t(l)("user.login.Remember me"),size:"default"},null,8,["modelValue","label"]),e.accountVerificationType.length>0?(c(),C("div",{key:0,onClick:o[9]||(o[9]=i=>e.showRetrievePasswordDialog=!0),class:"forgot-password"},m(t(l)("user.login.Forgot your password?")),1)):y("",!0)])):y("",!0),a(u,{class:"form-buttons"},{default:r(()=>[a(w,{class:"login-btn",onClick:o[10]||(o[10]=i=>U(V.value)),loading:e.formLoading,round:"",type:"primary",size:"large"},{default:r(()=>[p(m(t(l)("user.login."+e.form.tab)),1)]),_:1},8,["loading"]),e.form.tab=="register"?(c(),v(w,{key:0,onClick:o[11]||(o[11]=i=>I(V.value,"login")),round:"",plain:"",type:"info",size:"large"},{default:r(()=>[p(m(t(l)("user.login.Back to login")),1)]),_:1})):(c(),v(w,{key:1,onClick:o[12]||(o[12]=i=>I(V.value,"register")),round:"",plain:"",type:"info",size:"large"},{default:r(()=>[p(m(t(l)("user.login.No account yet? Click Register")),1)]),_:1}))]),_:1}),a(Pe)]),_:1},8,["rules","model"])])):(c(),v(oe,{key:1,center:!0,title:n.$t("Member center disabled"),type:"error"},null,8,["title"]))]),_:1})]),_:1})]),_:1}),a(me)]),_:1}),a(re,{"close-on-click-modal":!1,"close-on-press-escape":!1,modelValue:e.showRetrievePasswordDialog,"onUpdate:modelValue":o[22]||(o[22]=i=>e.showRetrievePasswordDialog=i),title:t(l)("user.login.Retrieve password"),width:e.dialogWidth+"%",draggable:!0},{default:r(()=>[S("div",Se,[a(D,{ref_key:"retrieveFormRef",ref:k,onKeyup:o[21]||(o[21]=W(i=>$(k.value),["enter"])),rules:X,model:e.retrievePasswordForm,"label-width":100},{default:r(()=>[a(u,{label:t(l)("user.login.Retrieval method")},{default:r(()=>[a(h,{modelValue:e.retrievePasswordForm.type,"onUpdate:modelValue":o[14]||(o[14]=i=>e.retrievePasswordForm.type=i)},{default:r(()=>[a(s,{label:"email",disabled:!e.accountVerificationType.includes("email"),border:""},{default:r(()=>[p(m(t(l)("user.login.Via email")),1)]),_:1},8,["disabled"]),a(s,{label:"mobile",disabled:!e.accountVerificationType.includes("mobile"),border:""},{default:r(()=>[p(m(t(l)("user.login.Via mobile number")),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(u,{prop:"account",label:e.retrievePasswordForm.type=="email"?t(l)("user.login.email"):t(l)("user.login.mobile")},{default:r(()=>[a(b,{modelValue:e.retrievePasswordForm.account,"onUpdate:modelValue":o[15]||(o[15]=i=>e.retrievePasswordForm.account=i),placeholder:t(l)("Please input field",{field:e.retrievePasswordForm.type=="email"?t(l)("user.login.email"):t(l)("user.login.mobile")}),clearable:!0},{prefix:r(()=>[a(g,{name:"fa fa-user",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{prop:"captcha",label:t(l)("user.login.Verification Code")},{default:r(()=>[a(F,{class:"w100"},{default:r(()=>[a(_,{span:16},{default:r(()=>[a(b,{modelValue:e.retrievePasswordForm.captcha,"onUpdate:modelValue":o[16]||(o[16]=i=>e.retrievePasswordForm.captcha=i),placeholder:t(l)("Please input field",{field:t(l)("user.login.Verification Code")}),autocomplete:"off"},{prefix:r(()=>[a(g,{name:"fa fa-ellipsis-h",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1}),a(_,{class:"captcha-box",span:8},{default:r(()=>[a(w,{onClick:o[17]||(o[17]=i=>Z(k.value)),loading:e.sendCaptchaLoading,disabled:!(e.codeSendCountdown<=0),type:"primary"},{default:r(()=>[p(m(e.codeSendCountdown<=0?t(l)("user.login.send"):e.codeSendCountdown+t(l)("user.login.seconds")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["label"]),a(u,{prop:"password",label:t(l)("user.login.New password")},{default:r(()=>[a(b,{modelValue:e.retrievePasswordForm.password,"onUpdate:modelValue":o[18]||(o[18]=i=>e.retrievePasswordForm.password=i),placeholder:t(l)("Please input field",{field:t(l)("user.login.New password")}),"show-password":""},{prefix:r(()=>[a(g,{name:"fa fa-unlock-alt",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,null,{default:r(()=>[a(w,{onClick:o[19]||(o[19]=i=>e.showRetrievePasswordDialog=!1)},{default:r(()=>[p(m(t(l)("Cancel")),1)]),_:1}),a(w,{loading:e.submitRetrieveLoading,onClick:o[20]||(o[20]=i=>$(k.value)),type:"primary"},{default:r(()=>[p(m(t(l)("user.login.second")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["rules","model"])])]),_:1},8,["modelValue","title","width"])])}}});const Ke=A(Le,[["__scopeId","data-v-1d93993d"]]);export{Ke as default};
