import{h as W,w as K,ar as R,r as C,F as j,E as O,q as p,X as _,o as m,O as u,P as d,_ as w,k as b,V as x,U,z as e,m as F,l as L,p as s,$ as X,a9 as Y,Z as V,Y as y,W as h}from"./vue-69ad5a16.js";import{w as Z,c as z}from"./index-32d6febb.js";import{F as n}from"./index-4042c46c.js";import{b as S}from"./validate-4db1e214.js";import G from"./index-f5346b54.js";import{_ as H}from"./index.vue_vue_type_script_setup_true_lang-fce1224c.js";const J={class:"title"},ie=W({__name:"popupForm",setup(Q){const v=K(),l=R("baTable"),i=C({fields:[],template:[],temp:{index:[],info:[]},current_id:0,activeTab:"base",moduleList:[],catalogList:[]}),T=()=>{z({url:"/admin/cms.catalog/getTemplate",method:"post",data:{}},{showSuccessMessage:!1}).then(r=>{i.template=r.data;const o=l.form.items.module_id||0;console.log(i.template,o,i.template[o]),i.temp.index=i.template[o].index,i.temp.info=i.template[o].info})};l.before={onSubmit:function(r){i.current_id=l.form.items.id},toggleForm:function(){i.current_id=0,i.activeTab="base"}},l.after={requestEdit:function(r){let o=[];for(const f in r.res.data.fields)o.push(r.res.data.fields[f]);i.fields=o}},T(),j(()=>l.form.items.module_id,r=>{r>0&&(i.temp.index=i.template[r].index,i.temp.info=i.template[r].info)});const{t:a}=Z();O(()=>{z({url:"/admin/cms.catalog/initCatalog",method:"post",data:{}},{showSuccessMessage:!1}).then(r=>{i.moduleList=r.data.moduleList,i.catalogList=r.data.catalogList})});const $=C({title:[S({name:"required",title:a("cms.catalog.title")})],catdir:[S({name:"required",title:a("cms.catalog.catdir")})]});return(r,o)=>{const f=p("el-option"),g=p("el-select"),c=p("el-form-item"),k=p("el-tab-pane"),q=p("el-tabs"),A=p("el-form"),B=p("el-scrollbar"),P=p("el-button"),D=p("el-dialog"),E=_("drag"),I=_("zoom"),M=_("loading"),N=_("blur");return m(),u(D,{fullscreen:!0,class:"ba-operate-dialog","close-on-click-modal":!1,"model-value":!!e(l).form.operate,onClose:e(l).toggleForm},{header:d(()=>[w((m(),b("div",J,[x(U(e(l).form.operate?e(a)(e(l).form.operate):""),1)])),[[E,[".ba-operate-dialog",".el-dialog__header"]],[I,".ba-operate-dialog"]])]),footer:d(()=>[F("div",{style:L("width: calc(100% - "+e(l).form.labelWidth/1.8+"px)")},[s(P,{onClick:o[19]||(o[19]=t=>e(l).toggleForm(""))},{default:d(()=>[x(U(e(a)("Cancel")),1)]),_:1}),w((m(),u(P,{loading:e(l).form.submitLoading,onClick:o[20]||(o[20]=t=>e(l).onSubmit(v.value)),type:"primary"},{default:d(()=>[x(U(e(l).form.operateIds&&e(l).form.operateIds.length>1?e(a)("Save and edit next item"):e(a)("Save")),1)]),_:1},8,["loading"])),[[N]])],4)]),default:d(()=>[w((m(),u(B,{class:"ba-table-form-scrollbar"},{default:d(()=>[F("div",{class:X(["ba-operate-form","ba-"+e(l).form.operate+"-form"])},[e(l).form.loading?h("",!0):(m(),u(A,{key:0,ref_key:"formRef",ref:v,onKeyup:o[18]||(o[18]=Y(t=>e(l).onSubmit(v.value),["enter"])),model:e(l).form.items,"label-position":"right","label-width":e(l).form.labelWidth+"px",rules:$},{default:d(()=>[s(q,{"tab-position":"left",class:"catalog-tabs",modelValue:i.activeTab,"onUpdate:modelValue":o[17]||(o[17]=t=>i.activeTab=t)},{default:d(()=>[s(k,{label:e(a)("cms.catalog.base"),name:"base"},{default:d(()=>[s(n,{label:e(a)("cms.catalog.title"),type:"string",modelValue:e(l).form.items.title,"onUpdate:modelValue":o[0]||(o[0]=t=>e(l).form.items.title=t),prop:"title","input-attr":{placeholder:e(a)("Please input field",{field:e(a)("cms.catalog.title")})}},null,8,["label","modelValue","input-attr"]),s(n,{label:e(a)("cms.catalog.catdir"),type:"string",modelValue:e(l).form.items.catdir,"onUpdate:modelValue":o[1]||(o[1]=t=>e(l).form.items.catdir=t),prop:"catdir","input-attr":{placeholder:e(a)("Please input field",{field:e(a)("cms.catalog.catdir")})}},null,8,["label","modelValue","input-attr"]),s(c,{label:e(a)("cms.catalog.module_id"),prop:"module_id"},{default:d(()=>[s(g,{modelValue:e(l).form.items.module_id,"onUpdate:modelValue":o[2]||(o[2]=t=>e(l).form.items.module_id=t),class:"w100",placeholder:e(a)("Please select field",{field:e(a)("cms.catalog.module_id")})},{default:d(()=>[(m(!0),b(V,null,y(i.moduleList,t=>(m(),u(f,{key:t.id,label:t.title,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s(c,{label:e(a)("cms.catalog.pid"),prop:"pid"},{default:d(()=>[s(g,{modelValue:e(l).form.items.pid,"onUpdate:modelValue":o[3]||(o[3]=t=>e(l).form.items.pid=t),class:"w100",placeholder:e(a)("Please select field",{field:e(a)("cms.catalog.module_id")})},{default:d(()=>[(m(!0),b(V,null,y(i.catalogList,t=>(m(),u(f,{disabled:t.id>0&&i.current_id==t.id,key:t.id,label:t.title,value:t.id},null,8,["disabled","label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s(n,{label:e(a)("cms.catalog.show"),type:"radio",modelValue:e(l).form.items.show,"onUpdate:modelValue":o[4]||(o[4]=t=>e(l).form.items.show=t),"input-attr":{size:"large"},data:{childrenAttr:{border:!0},content:{0:"不显示",1:"都显示",2:"头部显示",3:"底部显示"}}},null,8,["label","modelValue"]),s(n,{label:e(a)("cms.catalog.links_type"),type:"radio",modelValue:e(l).form.items.links_type,"onUpdate:modelValue":o[5]||(o[5]=t=>e(l).form.items.links_type=t),"input-attr":{size:"large"},data:{childrenAttr:{border:!0},content:{0:"默认",1:"指定"}}},null,8,["label","modelValue"]),s(c,{label:e(a)("cms.catalog.links_value"),prop:"links_value",style:L(e(l).form.items.links_type=="1"?"display: flex":"display: none")},{default:d(()=>[s(H,{modelValue:e(l).form.items.links_value,"onUpdate:modelValue":o[6]||(o[6]=t=>e(l).form.items.links_value=t),size:""},null,8,["modelValue"])]),_:1},8,["label","style"]),s(n,{label:e(a)("cms.catalog.description"),type:"textarea",modelValue:e(l).form.items.description,"onUpdate:modelValue":o[7]||(o[7]=t=>e(l).form.items.description=t),prop:"description","input-attr":{rows:3,placeholder:e(a)("Please input field",{field:e(a)("cms.catalog.description")})}},null,8,["label","modelValue","input-attr"]),s(n,{label:e(a)("cms.catalog.weigh"),type:"number",prop:"weigh",modelValue:e(l).form.items.weigh,"onUpdate:modelValue":o[8]||(o[8]=t=>e(l).form.items.weigh=t),modelModifiers:{number:!0},"input-attr":{step:"1",placeholder:e(a)("Please input field",{field:e(a)("cms.catalog.weigh")})}},null,8,["label","modelValue","input-attr"]),s(n,{label:"多栏目设置",type:"checkbox",modelValue:e(l).form.items.change_all,"onUpdate:modelValue":o[9]||(o[9]=t=>e(l).form.items.change_all=t),"input-attr":{size:"large"},data:{childrenAttr:{border:!0},content:{1:"将以下设置应用到所有子栏目"}}},null,8,["modelValue"]),s(n,{label:e(a)("cms.catalog.status"),type:"radio",modelValue:e(l).form.items.status,"onUpdate:modelValue":o[10]||(o[10]=t=>e(l).form.items.status=t),prop:"status",data:{content:{0:e(a)("cms.catalog.status 0"),1:e(a)("cms.catalog.status 1")}},"input-attr":{placeholder:e(a)("Please select field",{field:e(a)("cms.catalog.status")})}},null,8,["label","modelValue","data","input-attr"]),s(c,{label:e(a)("cms.catalog.template_index"),prop:"template_index"},{default:d(()=>[s(g,{modelValue:e(l).form.items.template_index,"onUpdate:modelValue":o[11]||(o[11]=t=>e(l).form.items.template_index=t),clearable:"",placeholder:e(a)("Please select field",{field:e(a)("cms.catalog.template_index")}),class:"w100"},{default:d(()=>[(m(!0),b(V,null,y(i.temp.index,t=>(m(),u(f,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(l).form.items.module_id>0?(m(),u(c,{key:0,label:e(a)("cms.catalog.template_info"),prop:"template_info"},{default:d(()=>[s(g,{modelValue:e(l).form.items.template_info,"onUpdate:modelValue":o[12]||(o[12]=t=>e(l).form.items.template_info=t),clearable:"",placeholder:e(a)("Please select field",{field:e(a)("cms.catalog.template_info")}),class:"w100"},{default:d(()=>[(m(!0),b(V,null,y(i.temp.info,t=>(m(),u(f,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):h("",!0)]),_:1},8,["label"]),s(k,{label:e(a)("cms.catalog.seo"),name:"seo"},{default:d(()=>[s(n,{label:e(a)("cms.catalog.seo_title"),type:"string",modelValue:e(l).form.items.seo_title,"onUpdate:modelValue":o[13]||(o[13]=t=>e(l).form.items.seo_title=t),prop:"seo_title","input-attr":{placeholder:e(a)("Please input field",{field:e(a)("cms.catalog.seo_title")})}},null,8,["label","modelValue","input-attr"]),s(n,{label:e(a)("cms.catalog.seo_keywords"),type:"string",modelValue:e(l).form.items.seo_keywords,"onUpdate:modelValue":o[14]||(o[14]=t=>e(l).form.items.seo_keywords=t),prop:"seo_keywords","input-attr":{placeholder:e(a)("Please input field",{field:e(a)("cms.catalog.seo_keywords")})}},null,8,["label","modelValue","input-attr"]),s(n,{label:e(a)("cms.catalog.seo_description"),type:"textarea",modelValue:e(l).form.items.seo_description,"onUpdate:modelValue":o[15]||(o[15]=t=>e(l).form.items.seo_description=t),prop:"seo_description","input-attr":{placeholder:e(a)("Please input field",{field:e(a)("cms.catalog.seo_description")})}},null,8,["label","modelValue","input-attr"])]),_:1},8,["label"]),s(k,{label:e(a)("cms.catalog.extend"),name:"extend",style:{height:"100%"}},{default:d(()=>[e(l).form.operate?(m(),u(G,{key:0,modelValue:e(l).form.items.field,"onUpdate:modelValue":o[16]||(o[16]=t=>e(l).form.items.field=t),ifset:!0},null,8,["modelValue"])):h("",!0)]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["model","label-width","rules"]))],2)]),_:1})),[[M,e(l).form.loading]])]),_:1},8,["model-value","onClose"])}}});export{ie as _};
