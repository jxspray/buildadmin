import{y as Z,d as ke,C as ce,o as Ee,an as A,I as Q,n as ue,ar as fe,a as s,s as v,v as p,e as m,b as u,T as I,c as h,R as T,Q as S,u as i,V,U as D,S as N,Y as pe,z as be,t as ge,a4 as Re,ab as Ae,r as k,X as ye,Z as Be,_ as Oe,W as Ge,a3 as he}from"./vue-9a46e809.js";import{S as ve,B as Fe}from"./index-81eda047.js";import{F}from"./index-a7be6d6a.js";import{i as l,a as qe}from"./index-ae07247d.js";import{f as U,z as je,H as X,_ as ze}from"./common-535f3731.js";import{b as B}from"./validate-61c16ed0.js";import{_ as Me}from"./_plugin-vue_export-helper-c27b6911.js";import"./random-1d7fa280.js";import"./iconfont-76d408a9.js";import"./index-01bed986.js";import"./controllerUrls-941681c3.js";import"./index-e2596456.js";const w=Z({step:"Start",type:"",startData:{db:"",sql:"",logId:""}}),Se=g=>{if(w.type=g,g=="start"){w.step="Start";for(const o in w.startData)w.startData[o]=""}else w.step="Design"},O={common:[{title:l.global.t("crud.state.Primary key"),name:"id",type:"int",length:10,precision:0,default:"",null:!1,primaryKey:!0,unsigned:!0,autoIncrement:!0,comment:"ID",designType:"pk",formBuildExclude:!0,table:{},form:{}},{title:l.global.t("crud.state.Weight (drag and drop sorting)"),name:"weigh",type:"int",length:10,precision:0,default:"",null:!0,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("weigh"),designType:"weigh",table:{},form:{}},{title:l.global.t("state"),name:"status",type:"tinyint",length:1,precision:0,default:"1",null:!1,primaryKey:!1,unsigned:!0,autoIncrement:!1,comment:l.global.t("crud.state.Status:0=Disabled,1=Enabled"),designType:"switch",table:{},form:{}},{title:l.global.t("crud.state.remarks"),name:"remark",type:"varchar",length:255,precision:0,default:"empty string",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("crud.state.remarks"),designType:"textarea",tableBuildExclude:!0,table:{},form:{}},{title:l.global.t("updatetime"),name:"update_time",type:"bigint",length:16,precision:0,default:"null",null:!0,primaryKey:!1,unsigned:!0,autoIncrement:!1,comment:l.global.t("updatetime"),designType:"timestamp",formBuildExclude:!0,table:{},form:{}},{title:l.global.t("createtime"),name:"create_time",type:"bigint",length:16,precision:0,default:"null",null:!0,primaryKey:!1,unsigned:!0,autoIncrement:!1,comment:l.global.t("createtime"),designType:"timestamp",formBuildExclude:!0,table:{},form:{}},{title:l.global.t("crud.state.Remote Select (association table)"),name:"user_id",type:"int",length:10,precision:0,default:"0",null:!1,primaryKey:!1,unsigned:!0,autoIncrement:!1,comment:l.global.t("utils.remote select"),designType:"remoteSelect",tableBuildExclude:!0,table:{},form:{}}],base:[{title:l.global.t("utils.string"),name:"string",type:"varchar",length:200,precision:0,default:"empty string",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.string"),designType:"string",table:{},form:{}},{title:l.global.t("utils.image"),name:"image",type:"varchar",length:200,precision:0,default:"empty string",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.image"),designType:"image",table:{},form:{}},{title:l.global.t("utils.file"),name:"file",type:"varchar",length:200,precision:0,default:"empty string",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.file"),designType:"file",tableBuildExclude:!0,table:{},form:{}},{title:l.global.t("utils.radio"),name:"radio",type:"enum",dataType:"enum('opt0','opt1')",length:0,precision:0,default:"opt0",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("crud.state.Radio:opt0=Option1,opt1=Option2"),designType:"radio",table:{},form:{}},{title:l.global.t("utils.checkbox"),name:"checkbox",type:"set",dataType:"set('opt0','opt1')",length:0,precision:0,default:"opt0,opt1",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("crud.state.Checkbox:opt0=Option1,opt1=Option2"),designType:"checkbox",table:{},form:{}},{title:l.global.t("utils.select"),name:"select",type:"tinyint",length:1,precision:0,default:"0",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("crud.state.Select:0=Option1,1=Option2"),designType:"select",table:{},form:{}},{title:l.global.t("utils.switch"),name:"switch",type:"tinyint",length:1,precision:0,default:"1",null:!1,primaryKey:!1,unsigned:!0,autoIncrement:!1,comment:l.global.t("crud.state.Switch:0=off,1=on"),designType:"switch",table:{},form:{}},{title:l.global.t("utils.rich Text"),name:"editor",type:"text",length:0,precision:0,default:"null",null:!0,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.rich Text"),designType:"editor",tableBuildExclude:!0,table:{},form:{}},{title:l.global.t("utils.textarea"),name:"textarea",type:"varchar",length:255,precision:0,default:"empty string",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.textarea"),designType:"textarea",tableBuildExclude:!0,table:{},form:{}},{title:l.global.t("utils.number"),name:"number",type:"int",length:10,precision:0,default:"0",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.number"),designType:"number",table:{},form:{}},{title:l.global.t("utils.float"),name:"float",type:"decimal",length:5,precision:2,default:"0",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.float"),designType:"float",table:{},form:{}},{title:l.global.t("utils.password"),name:"password",type:"varchar",length:32,precision:0,default:"empty string",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.password"),designType:"password",tableBuildExclude:!0,table:{},form:{}},{title:l.global.t("utils.date"),name:"date",type:"date",length:0,precision:0,default:"null",null:!0,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.date"),designType:"date",table:{},form:{}},{title:l.global.t("utils.time"),name:"time",type:"time",length:0,precision:0,default:"null",null:!0,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.time"),designType:"time",table:{},form:{}},{title:l.global.t("utils.time date"),name:"datetime",type:"datetime",length:0,precision:0,default:"null",null:!0,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.time date"),designType:"datetime",table:{},form:{}},{title:l.global.t("utils.year"),name:"year",type:"year",length:4,precision:0,default:"null",null:!0,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.year"),designType:"year",table:{},form:{}},{title:l.global.t("crud.state.Time date (timestamp storage)"),name:"timestamp",type:"bigint",length:16,precision:0,default:"null",null:!0,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.time date"),designType:"timestamp",table:{},form:{}}],senior:[{title:l.global.t("utils.array"),name:"array",type:"varchar",length:255,precision:0,default:"empty string",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.array"),designType:"array",tableBuildExclude:!0,table:{},form:{}},{title:l.global.t("utils.city select"),name:"city",type:"varchar",length:100,precision:0,default:"empty string",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.city select"),designType:"city",table:{},form:{}},{title:l.global.t("utils.icon select"),name:"icon",type:"varchar",length:50,precision:0,default:"empty string",null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1,comment:l.global.t("utils.icon select"),designType:"icon",table:{},form:{}}]},K={render:{type:"select",value:"none",options:{none:l.global.t("none"),icon:"Icon",switch:l.global.t("utils.switch"),image:l.global.t("utils.image"),images:l.global.t("utils.multi image"),tag:"Tag",tags:"Tags",url:"URL",datetime:l.global.t("utils.time date")}},operator:{type:"select",value:"=",options:{false:l.global.t("crud.state.Disable Search"),"=":"=","<>":"!=",">":">",">=":">=","<":"<","<=":"<=",LIKE:"LIKE","NOT LIKE":"NOT LIKE",IN:"IN","NOT IN":"NOT IN",RANGE:"RANGE","NOT RANGE":"NOT RANGE",NULL:"NULL","NOT NULL":"NOT NULL",FIND_IN_SET:"FIND_IN_SET"}},sortable:{type:"select",value:"false",options:{false:l.global.t("Disable"),custom:l.global.t("Enable")}}},b={validator:{type:"selects",value:[],options:{required:l.global.t("validate.required"),mobile:l.global.t("utils.mobile"),account:l.global.t("utils.account"),password:l.global.t("utils.password"),varName:l.global.t("utils.variable name"),editorRequired:l.global.t("validate.editor required"),number:l.global.t("utils.number"),integer:l.global.t("utils.integer"),float:l.global.t("utils.float"),date:l.global.t("utils.date"),url:"URL",email:l.global.t("utils.email")}},validatorMsg:{type:"textarea",value:"",placeholder:l.global.t("crud.state.If left blank, the verifier title attribute will be filled in automatically"),attr:{rows:3}}},d=(g,o)=>({...K[g],value:o}),C=(g,o)=>({...b[g],value:o}),_e={pk:{name:l.global.t("crud.state.Primary key"),table:{width:{type:"number",value:70},operator:d("operator","RANGE"),sortable:d("sortable","custom")},form:{}},weigh:{name:l.global.t("crud.state.Weight (automatically generate drag sort button)"),table:{operator:d("operator","RANGE"),sortable:d("sortable","custom")},form:b},timestamp:{name:l.global.t("crud.state.Time date (timestamp storage)"),table:{render:d("render","datetime"),operator:d("operator","RANGE"),sortable:d("sortable","custom"),width:{type:"number",value:160},timeFormat:{type:"string",value:"yyyy-mm-dd hh:MM:ss"}},form:{...b,validator:C("validator",["date"])}},string:{name:l.global.t("utils.string"),table:{...K,operator:d("operator","LIKE")},form:b},password:{name:l.global.t("utils.password"),table:{operator:d("operator","false")},form:{...b,validator:C("validator",["password"])}},number:{name:l.global.t("utils.number"),table:{...K,operator:d("operator","RANGE")},form:{...b,validator:C("validator",["number"]),step:{type:"number",value:1}}},float:{name:l.global.t("utils.float"),table:{...K,operator:d("operator","RANGE")},form:{...b,validator:C("validator",["float"]),step:{type:"number",value:1}}},radio:{name:l.global.t("utils.radio"),table:{...K,render:d("render","tag")},form:b},checkbox:{name:l.global.t("utils.checkbox"),table:{...K,render:d("render","tags")},form:b},switch:{name:l.global.t("utils.switch"),table:{...K,render:d("render","switch")},form:b},textarea:{name:l.global.t("utils.textarea"),table:{operator:d("operator","false")},form:{...b,rows:{type:"number",value:3}}},array:{name:l.global.t("utils.array"),table:{operator:d("operator","false")},form:b},datetime:{name:l.global.t("utils.time date")+l.global.t("utils.choice"),table:{operator:d("operator","="),sortable:d("sortable","custom"),width:{type:"number",value:160}},form:{...b,validator:C("validator",["date"])}},year:{name:l.global.t("utils.year")+l.global.t("utils.choice"),table:{operator:d("operator","RANGE"),sortable:d("sortable","custom")},form:{...b,validator:C("validator",["date"])}},date:{name:l.global.t("utils.date")+l.global.t("utils.choice"),table:{operator:d("operator","="),sortable:d("sortable","custom")},form:{...b,validator:C("validator",["date"])}},time:{name:l.global.t("utils.time")+l.global.t("utils.choice"),table:{operator:d("operator","="),sortable:d("sortable","custom")},form:b},select:{name:l.global.t("utils.select"),table:{...K,render:d("render","tags")},form:{...b,"select-multi":{type:"switch",value:!1}}},remoteSelect:{name:l.global.t("utils.remote select")+l.global.t("utils.choice"),table:{operator:d("operator","LIKE")},form:{...b,"select-multi":{type:"switch",value:!1},"remote-pk":{type:"string",value:"id"},"remote-field":{type:"string",value:"name"},"remote-table":{type:"string",value:""},"remote-controller":{type:"string",value:""},"remote-model":{type:"string",value:""},"relation-fields":{type:"string",value:""},"remote-url":{type:"string",value:"",placeholder:l.global.t("crud.state.If it is not input, it will be automatically analyzed by the controller")}}},editor:{name:l.global.t("utils.rich Text"),table:{operator:d("operator","false")},form:{...b,validator:C("validator",["editorRequired"])}},city:{name:l.global.t("utils.city select"),table:{operator:d("operator","LIKE")},form:b},image:{name:l.global.t("utils.image")+l.global.t("Upload"),table:{render:d("render","image"),operator:d("operator","false")},form:{...b,"image-multi":{type:"switch",value:!1}}},file:{name:l.global.t("utils.file")+l.global.t("Upload"),table:{render:d("render","none"),operator:d("operator","false")},form:{...b,"file-multi":{type:"switch",value:!1}}},icon:{name:l.global.t("utils.icon select"),table:{render:d("render","icon"),operator:d("operator","false")},form:b}},L=["quickSearchField","formFields","columnFields"],E="/admin/cms.fields/";function $e(g){return U({url:E+"generate",method:"post",data:g},{showSuccessMessage:!0})}function Je(){return U({url:E+"databaseList",method:"get"})}function we(g){return U({url:E+"getFileData",method:"get",params:{table:g}})}function We(g){return U({url:E+"generateCheck",method:"post",data:g},{showCodeMessage:!1})}function He(g,o="",z=""){return U({url:E+"parseFieldData",method:"post",data:{type:g,table:o,sql:z}})}function Ye(g){return U({url:E+"logStart",method:"post",data:{id:g}})}const Qe=g=>(Be("data-v-de5dcd78"),g=g(),Oe(),g),Xe={class:"default-main"},Ze={class:"header-config-box"},et={class:"header"},tt={class:"header-right"},lt=["onClick","data-id"],at={class:"design-field"},ot={class:"design-field"},rt={class:"design-field-right"},it={key:0,class:"design-field-empty"},nt={class:"field-config ba-scroll-style"},st={key:0,class:"design-field-empty"},dt={class:"field-inline"},mt={class:"field-inline"},ct={class:"field-inline"},ut={class:"confirm-generate-dialog-body"},ft=Qe(()=>p("br",null,null,-1)),pt={class:"confirm-generate-dialog-footer"},bt=ke({name:"cms/fields"}),gt=ke({...bt,setup(g){const{t:o}=qe(),z=Ge(),ee=ce(),M=ce(),G=je();let te=1;const e=Z({loading:{init:!1,generate:!1,remoteSelect:!1},table:{name:"",comment:"",quickSearchField:[],defaultSortField:"",formFields:[],columnFields:[],defaultSortType:"desc",modelFile:"",controllerFile:"",validateFile:"",webViewsDir:""},fields:[],activateField:-1,fieldCollapseName:["common","base","senior"],remoteSelectPre:{show:!1,index:-1,dbList:[],fieldList:[],modelFileList:[],controllerFileList:[],loading:!1,hideDelField:!1,form:{table:"",pk:"",label:"",joinField:[],modelFile:"",controllerFile:""}},showHeaderSeniorConfig:!1,confirmGenerate:{show:!1,table:!1,controller:!1}}),Pe=a=>{e.activateField=a},Te=()=>{const a=A(e.fields[e.activateField]);for(const t in a.table)a.table[t]=a.table[t].value;for(const t in a.form)a.form[t]=a.form[t].value;e.fields[e.activateField]=q(a)},le=a=>{for(const t in L)for(const n in e.table[L[t]])X(e.fields,"name",e.table[L[t]][n])||(e.table[L[t]][n]=a);e.table.defaultSortField&&(X(e.fields,"name",e.table.defaultSortField)||(e.table.defaultSortField=a))},ae=a=>{if(e.fields[a]){e.activateField===a&&(e.activateField=-1),e.fields[a].name==e.table.defaultSortField&&(e.table.defaultSortField="");for(const t in L){const n=e.table[L[t]].findIndex(f=>f==e.fields[a].name);n!=-1&&e.table[L[t]].splice(n,1)}e.fields.splice(a,1)}},oe=(a,t=!1)=>{e.remoteSelectPre.show=!0,e.remoteSelectPre.loading=!0,e.remoteSelectPre.index=a,e.remoteSelectPre.hideDelField=t,Je().then(n=>{e.remoteSelectPre.dbList=n.data.dbs,e.fields[a]&&e.fields[a].form["remote-table"].value&&(e.remoteSelectPre.form.table=e.fields[a].form["remote-table"].value,e.remoteSelectPre.form.pk=e.fields[a].form["remote-pk"].value,e.remoteSelectPre.form.label=e.fields[a].form["remote-field"].value,e.remoteSelectPre.form.controllerFile=e.fields[a].form["remote-controller"].value,e.remoteSelectPre.form.modelFile=e.fields[a].form["remote-model"].value,e.remoteSelectPre.form.joinField=e.fields[a].form["relation-fields"].value.split(","))}).finally(()=>{e.remoteSelectPre.loading=!1})},Ve=(a,t)=>{if(t.designType=="remoteSelect")return oe(a)},$=()=>{e.confirmGenerate.show=!1},re=()=>{e.loading.generate=!0;const a=A(e.fields);for(const t in a){for(const n in a[t].table)a[t].table[n]=a[t].table[n].value;for(const n in a[t].form)a[t].form[n]=a[t].form[n].value}$e({table:e.table,fields:a}).then(()=>{z.go(0)}).finally(()=>{e.loading.generate=!1,$()})},Ie=()=>{let a="";if(e.table.name||(a=o("crud.crud.Please enter the data table name!")),e.fields.findIndex(n=>n.primaryKey)===-1&&(a=o("crud.crud.Please design the primary key field!")),a){Q({type:"error",message:a});return}e.loading.generate=!0,We({table:e.table.name,controllerFile:e.table.controllerFile}).then(()=>{re()}).catch(n=>{e.loading.generate=!1,n.code==-1?(e.confirmGenerate.show=!0,e.confirmGenerate.table=n.data.table,e.confirmGenerate.controller=n.data.controller):Q({type:"error",message:n.msg})})},Ce=()=>{if(!e.table.name&&!e.table.comment&&!e.fields.length)return Se("start");Ae.confirm(o("crud.crud.It is irreversible to give up the design Are you sure you want to give up?"),o("Reminder"),{confirmButtonText:o("crud.crud.give up"),cancelButtonText:o("Cancel"),type:"warning"}).then(()=>{Se("start")}).catch(()=>{})},q=a=>{const t=A(_e[a.designType]);for(const n in a.form)t.form[n]&&(t.form[n].value=a.form[n]),n=="image-multi"&&a.form[n]&&(t.table.render=d("render","images"));for(const n in a.table)t.table[n]&&(t.table[n].value=a.table[n]);return a.form=t.form,a.table=t.table,a},Ke=()=>{if(["db","sql","log"].includes(w.type)){if(e.loading.init=!0,w.type=="log"){Ye(parseInt(w.startData.logId)).then(a=>{e.table=a.data.table;const t=a.data.fields;for(const n in t){const f=q(A(t[n]));e.fields.push(f)}}).finally(()=>{e.loading.init=!1});return}He(w.type,w.startData.db,w.startData.sql).then(a=>{let t=[];for(const n in a.data.columns){const f=q(a.data.columns[n]);["id","update_time","create_time","updatetime","createtime"].includes(f.name)||e.table.formFields.push(f.name),["textarea","file","editor","password","array"].includes(f.designType)||e.table.columnFields.push(f.name),f.designType=="pk"&&(e.table.defaultSortField=f.name,e.table.quickSearchField.push(f.name)),f.designType=="weigh"&&(e.table.defaultSortField=f.name),t.push(f)}e.fields=t,e.table.comment=a.data.comment,w.type=="db"&&w.startData.db&&(e.table.name=w.startData.db,De(w.startData.db))}).finally(()=>{e.loading.init=!1})}};Ee(()=>{Ke();const a=ve.create(ee.value,{group:"design-field",animation:200,filter:".design-field-empty",onAdd:t=>{var _,j;const n=(j=(_=t.originalEvent)==null?void 0:_.dataTransfer)==null?void 0:j.getData("name"),f=O[n];if(f&&f[t.oldIndex]){const y=q(A(f[t.oldIndex]));if(y.primaryKey==!0){if(e.fields.find(H=>H.primaryKey))return Q({type:"error",message:o("crud.crud.There can only be one primary key field")}),t.item.remove();e.table.defaultSortField=y.name,e.table.quickSearchField.push(y.name)}y.designType=="weigh"&&(e.table.defaultSortField=y.name),X(e.fields,"name",y.name)&&(y.name=y.name+te,te++),e.fields.splice(t.newIndex,0,y),y.designType=="remoteSelect"&&oe(t.newIndex,!0),y.formBuildExclude||e.table.formFields.push(y.name),y.tableBuildExclude||e.table.columnFields.push(y.name)}t.item.remove(),ue(()=>{a.sort(fe(e.fields.length).map(y=>y.toString()))})},onEnd:t=>{const n=e.fields[t.oldIndex];e.fields.splice(t.oldIndex,1),e.fields.splice(t.newIndex,0,n),ue(()=>{a.sort(fe(e.fields.length).map(f=>f.toString()))})}});G.value.forEach((t,n)=>{ve.create(t,{sort:!1,group:{name:"design-field",pull:"clone",put:!1},animation:200,setData:f=>{f.setData("name",Object.keys(O)[n])}})})});const De=a=>{a&&we(a).then(t=>{e.table.modelFile=t.data.modelFile,e.table.controllerFile=t.data.controllerFile,e.table.validateFile=t.data.validateFile,e.table.webViewsDir=t.data.webViewsDir})},Le=a=>{a&&(J(),e.remoteSelectPre.form.table=a,e.loading.remoteSelect=!0,ze(a).then(t=>{e.remoteSelectPre.form.pk=t.data.pk;const n=["name","title","username","nickname"];for(const _ in t.data.fieldlist)if(n.includes(_)){e.remoteSelectPre.form.label=_,e.remoteSelectPre.form.joinField.push(_);break}const f={};for(const _ in t.data.fieldlist)f[_]=(_?_+" - ":"")+t.data.fieldlist[_];e.remoteSelectPre.fieldList=f}).finally(()=>{e.loading.remoteSelect=!1}),we(a).then(t=>{e.remoteSelectPre.modelFileList=t.data.modelFileList,e.remoteSelectPre.controllerFileList=t.data.controllerFileList,Object.keys(t.data.modelFileList).includes(t.data.modelFile)&&(e.remoteSelectPre.form.modelFile=t.data.modelFile),Object.keys(t.data.controllerFileList).includes(t.data.controllerFile)&&(e.remoteSelectPre.form.controllerFile=t.data.controllerFile)}))},ie=()=>{const a=()=>{e.fields[e.remoteSelectPre.index].form["remote-table"].value=e.remoteSelectPre.form.table,e.fields[e.remoteSelectPre.index].form["remote-pk"].value=e.remoteSelectPre.form.pk,e.fields[e.remoteSelectPre.index].form["remote-field"].value=e.remoteSelectPre.form.label,e.fields[e.remoteSelectPre.index].form["remote-controller"].value=e.remoteSelectPre.form.controllerFile,e.fields[e.remoteSelectPre.index].form["remote-model"].value=e.remoteSelectPre.form.modelFile,e.fields[e.remoteSelectPre.index].form["relation-fields"].value=e.remoteSelectPre.form.joinField.join(","),e.remoteSelectPre.index=-1,e.remoteSelectPre.show=!1,J()};M.value&&M.value.validate(t=>{t&&a()})},ne=()=>{e.remoteSelectPre.show=!1,J(),e.remoteSelectPre.index!==-1&&e.remoteSelectPre.hideDelField&&ae(e.remoteSelectPre.index)},J=()=>{for(const a in e.remoteSelectPre.form)a=="joinField"?e.remoteSelectPre.form[a]=[]:e.remoteSelectPre.form[a]=""},xe=Z({table:[B({name:"required",title:o("crud.crud.remote-table")})],pk:[B({name:"required",title:o("crud.crud.Drop down value field")})],label:[B({name:"required",title:o("crud.crud.Drop down label field")})],joinField:[B({name:"required",title:o("crud.crud.Fields displayed in the table")})],controllerFile:[B({name:"required",title:o("crud.crud.Controller position")})]});return(a,t)=>{const n=k("el-button"),f=k("el-row"),_=k("el-collapse-item"),j=k("el-collapse"),y=k("el-col"),W=k("Icon"),R=k("el-divider"),H=k("el-option"),Ne=k("el-select"),Ue=k("el-form-item"),se=k("el-form"),de=k("el-dialog"),me=k("el-alert"),x=ye("blur"),Y=ye("loading");return s(),v("div",Xe,[p("div",Ze,[m(f,{class:"header-box"},{default:u(()=>[p("div",et,[p("div",tt,[I((s(),h(n,{type:"primary",loading:e.loading.generate,onClick:Ie},{default:u(()=>[T(S(i(o)("crud.crud.Generate CRUD code")),1)]),_:1},8,["loading"])),[[x]]),I((s(),h(n,{onClick:Ce,type:"danger"},{default:u(()=>[T(S(i(o)("crud.crud.give up")),1)]),_:1})),[[x]])])])]),_:1})]),I((s(),h(f,{class:"fields-box",gutter:20},{default:u(()=>[m(y,{xs:24,span:6},{default:u(()=>[m(j,{class:"field-collapse",modelValue:e.fieldCollapseName,"onUpdate:modelValue":t[0]||(t[0]=r=>e.fieldCollapseName=r)},{default:u(()=>[m(_,{title:i(o)("crud.crud.Common Fields"),name:"common"},{default:u(()=>[p("div",{class:"field-box",ref:i(G).set},[(s(!0),v(V,null,D(i(O).common,(r,c)=>(s(),v("div",{key:c,class:"field-item"},[p("span",null,S(r.title),1)]))),128))],512)]),_:1},8,["title"]),m(_,{title:i(o)("crud.crud.Base Fields"),name:"base"},{default:u(()=>[p("div",{class:"field-box",ref:i(G).set},[(s(!0),v(V,null,D(i(O).base,(r,c)=>(s(),v("div",{key:c,class:"field-item"},[p("span",null,S(r.title),1)]))),128))],512)]),_:1},8,["title"]),m(_,{title:i(o)("crud.crud.Advanced Fields"),name:"senior"},{default:u(()=>[p("div",{class:"field-box",ref:i(G).set},[(s(!0),v(V,null,D(i(O).senior,(r,c)=>(s(),v("div",{key:c,class:"field-item"},[p("span",null,S(r.title),1)]))),128))],512)]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}),m(y,{xs:24,span:12},{default:u(()=>[p("div",{ref_key:"designWindowRef",ref:ee,class:pe(["design-window ba-scroll-style",e.fields.length?"":"design-window-empty"])},[(s(!0),v(V,null,D(e.fields,(r,c)=>(s(),v("div",{key:c,class:pe([c===e.activateField?"activate":"","design-field-box"]),onClick:P=>Pe(c),"data-id":c},[p("div",at,[p("span",null,S(i(o)("crud.crud.Field Name"))+"：",1),m(Fe,{class:"design-field-name-input",modelValue:r.name,"onUpdate:modelValue":P=>r.name=P,type:"string",attr:{size:"small",onChange:le}},null,8,["modelValue","onUpdate:modelValue","attr"])]),p("div",ot,[p("span",null,S(i(o)("crud.crud.field comment"))+"：",1),m(Fe,{class:"design-field-name-comment",modelValue:r.comment,"onUpdate:modelValue":P=>r.comment=P,type:"string",attr:{size:"small"}},null,8,["modelValue","onUpdate:modelValue"])]),p("div",rt,[r.designType=="remoteSelect"?I((s(),h(n,{key:0,onClick:he(P=>Ve(c,r),["stop"]),type:"primary",size:"small",circle:""},{default:u(()=>[m(W,{color:"var(--el-color-white)",size:"15",name:"fa fa-pencil icon"})]),_:2},1032,["onClick"])),[[x]]):N("",!0),I((s(),h(n,{onClick:he(P=>ae(c),["stop"]),type:"danger",size:"small",circle:""},{default:u(()=>[m(W,{color:"var(--el-color-white)",size:"15",name:"fa fa-trash"})]),_:2},1032,["onClick"])),[[x]])])],10,lt))),128)),e.fields.length?N("",!0):(s(),v("div",it,S(i(o)("crud.crud.Drag the left element here to start designing CRUD")),1))],2)]),_:1}),m(y,{xs:24,span:6},{default:u(()=>[p("div",nt,[e.activateField===-1?(s(),v("div",st,S(i(o)("crud.crud.Please select a field from the left first")),1)):(s(),v("div",{key:"activate-field-"+e.activateField},[m(se,{"label-position":"top"},{default:u(()=>[m(R,{"content-position":"left"},{default:u(()=>[T(S(i(o)("crud.crud.Common")),1)]),_:1}),m(Ue,{label:i(o)("crud.crud.generate")},{default:u(()=>[m(Ne,{onChange:Te,class:"w100",modelValue:e.fields[e.activateField].designType,"onUpdate:modelValue":t[1]||(t[1]=r=>e.fields[e.activateField].designType=r),placement:"bottom"},{default:u(()=>[(s(!0),v(V,null,D(i(_e),(r,c)=>(s(),h(H,{key:c,label:r.name,value:c},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),m(F,{label:i(o)("crud.crud.Field comments (CRUD dictionary)"),type:"textarea","input-attr":{rows:2},placeholder:i(o)("crud.crud.The field comment will be used as the CRUD dictionary, and will be identified as the field title before the colon, and as the data dictionary after the colon"),modelValue:e.fields[e.activateField].comment,"onUpdate:modelValue":t[2]||(t[2]=r=>e.fields[e.activateField].comment=r)},null,8,["label","placeholder","modelValue"]),m(R,{"content-position":"left"},{default:u(()=>[T(S(i(o)("crud.crud.Field Properties")),1)]),_:1}),m(F,{label:i(o)("crud.crud.Field Name"),type:"string",modelValue:e.fields[e.activateField].name,"onUpdate:modelValue":t[3]||(t[3]=r=>e.fields[e.activateField].name=r),"input-attr":{onChange:le}},null,8,["label","modelValue","input-attr"]),e.fields[e.activateField].dataType?(s(),h(F,{key:0,label:i(o)("crud.crud.Field Type"),type:"textarea",modelValue:e.fields[e.activateField].dataType,"onUpdate:modelValue":t[4]||(t[4]=r=>e.fields[e.activateField].dataType=r)},null,8,["label","modelValue"])):(s(),v(V,{key:1},[m(F,{label:i(o)("crud.crud.Field Type"),type:"string",modelValue:e.fields[e.activateField].type,"onUpdate:modelValue":t[5]||(t[5]=r=>e.fields[e.activateField].type=r)},null,8,["label","modelValue"]),p("div",dt,[m(F,{label:i(o)("crud.crud.length"),type:"number",modelValue:e.fields[e.activateField].length,"onUpdate:modelValue":t[6]||(t[6]=r=>e.fields[e.activateField].length=r),modelModifiers:{number:!0}},null,8,["label","modelValue"]),m(F,{label:i(o)("crud.crud.decimal point"),type:"number",modelValue:e.fields[e.activateField].precision,"onUpdate:modelValue":t[7]||(t[7]=r=>e.fields[e.activateField].precision=r),modelModifiers:{number:!0}},null,8,["label","modelValue"])])],64)),m(F,{label:i(o)("crud.crud.Field Defaults"),placeholder:i(o)("crud.crud.You can directly enter null, 0, empty string"),type:"string",modelValue:e.fields[e.activateField].default,"onUpdate:modelValue":t[8]||(t[8]=r=>e.fields[e.activateField].default=r)},null,8,["label","placeholder","modelValue"]),p("div",mt,[m(F,{class:"form-item-position-right",label:i(o)("crud.state.Primary key"),type:"switch",modelValue:e.fields[e.activateField].primaryKey,"onUpdate:modelValue":t[9]||(t[9]=r=>e.fields[e.activateField].primaryKey=r)},null,8,["label","modelValue"]),m(F,{class:"form-item-position-right",label:i(o)("crud.crud.Auto increment"),type:"switch",modelValue:e.fields[e.activateField].autoIncrement,"onUpdate:modelValue":t[10]||(t[10]=r=>e.fields[e.activateField].autoIncrement=r)},null,8,["label","modelValue"])]),p("div",ct,[m(F,{class:"form-item-position-right",label:i(o)("crud.crud.Unsigned"),type:"switch",modelValue:e.fields[e.activateField].unsigned,"onUpdate:modelValue":t[11]||(t[11]=r=>e.fields[e.activateField].unsigned=r)},null,8,["label","modelValue"]),m(F,{class:"form-item-position-right",label:i(o)("crud.crud.Allow NULL"),type:"switch",modelValue:e.fields[e.activateField].null,"onUpdate:modelValue":t[12]||(t[12]=r=>e.fields[e.activateField].null=r)},null,8,["label","modelValue"])]),i(be)(e.fields[e.activateField].table)?N("",!0):(s(),v(V,{key:2},[m(R,{"content-position":"left"},{default:u(()=>[T(S(i(o)("crud.crud.Field Table Properties")),1)]),_:1}),(s(!0),v(V,null,D(e.fields[e.activateField].table,(r,c)=>(s(),h(F,{key:c,label:a.$t("crud.crud."+c),type:r.type,modelValue:e.fields[e.activateField].table[c].value,"onUpdate:modelValue":P=>e.fields[e.activateField].table[c].value=P,placeholder:e.fields[e.activateField].table[c].placeholder??"",data:{content:e.fields[e.activateField].table[c].options??{}},"input-attr":e.fields[e.activateField].table[c].attr??{}},null,8,["label","type","modelValue","onUpdate:modelValue","placeholder","data","input-attr"]))),128))],64)),i(be)(e.fields[e.activateField].form)?N("",!0):(s(),v(V,{key:3},[m(R,{"content-position":"left"},{default:u(()=>[T(S(i(o)("crud.crud.Field Form Properties")),1)]),_:1}),(s(!0),v(V,null,D(e.fields[e.activateField].form,(r,c)=>(s(),h(F,{key:c,label:a.$t("crud.crud."+c),type:r.type,modelValue:e.fields[e.activateField].form[c].value,"onUpdate:modelValue":P=>e.fields[e.activateField].form[c].value=P,placeholder:e.fields[e.activateField].form[c].placeholder??"",data:{content:e.fields[e.activateField].form[c].options??{}},"input-attr":e.fields[e.activateField].form[c].attr??{}},null,8,["label","type","modelValue","onUpdate:modelValue","placeholder","data","input-attr"]))),128))],64))]),_:1})]))])]),_:1})]),_:1})),[[Y,e.loading.init]]),m(de,{onClose:ne,class:"ba-operate-dialog","model-value":e.remoteSelectPre.show,title:i(o)("crud.crud.Remote drop-down association information"),"close-on-click-modal":!1,onKeyup:Re(ie,["enter"])},{footer:u(()=>[p("div",{style:ge("width: calc(100% - 88px)")},[m(n,{onClick:ne},{default:u(()=>[T(S(a.$t("Cancel")),1)]),_:1}),I((s(),h(n,{onClick:ie,type:"primary"},{default:u(()=>[T(S(a.$t("Save")),1)]),_:1})),[[x]])],4)]),default:u(()=>[p("div",{class:"ba-operate-form",style:ge("width: calc(100% - 80px)")},[I((s(),h(se,{ref_key:"formRef",ref:M,model:e.remoteSelectPre.form,rules:xe,"label-position":"right","label-width":"160px","destroy-on-close":!0},{default:u(()=>[(s(),h(F,{prop:"table",type:"select",label:i(o)("crud.crud.Associated Data Table"),modelValue:e.remoteSelectPre.form.table,"onUpdate:modelValue":t[13]||(t[13]=r=>e.remoteSelectPre.form.table=r),key:JSON.stringify(e.remoteSelectPre.dbList),data:{content:e.remoteSelectPre.dbList},"input-attr":{onChange:Le}},null,8,["label","modelValue","data","input-attr"])),I((s(),v("div",null,[(s(),h(F,{prop:"pk",type:"select",label:i(o)("crud.crud.Drop down value field"),modelValue:e.remoteSelectPre.form.pk,"onUpdate:modelValue":t[14]||(t[14]=r=>e.remoteSelectPre.form.pk=r),placeholder:i(o)("crud.crud.Please select the value field of the select component"),key:"select-value"+JSON.stringify(e.remoteSelectPre.fieldList),data:{content:e.remoteSelectPre.fieldList}},null,8,["label","modelValue","placeholder","data"])),(s(),h(F,{prop:"label",type:"select",label:i(o)("crud.crud.Drop down label field"),modelValue:e.remoteSelectPre.form.label,"onUpdate:modelValue":t[15]||(t[15]=r=>e.remoteSelectPre.form.label=r),placeholder:i(o)("crud.crud.Please select the label field of the select component"),key:"select-label"+JSON.stringify(e.remoteSelectPre.fieldList),data:{content:e.remoteSelectPre.fieldList}},null,8,["label","modelValue","placeholder","data"])),(s(),h(F,{prop:"joinField",type:"selects",label:i(o)("crud.crud.Fields displayed in the table"),modelValue:e.remoteSelectPre.form.joinField,"onUpdate:modelValue":t[16]||(t[16]=r=>e.remoteSelectPre.form.joinField=r),placeholder:i(o)("crud.crud.Please select the fields displayed in the table"),key:"join-field"+JSON.stringify(e.remoteSelectPre.fieldList),data:{content:e.remoteSelectPre.fieldList}},null,8,["label","modelValue","placeholder","data"])),(s(),h(F,{prop:"controllerFile",type:"select",label:i(o)("crud.crud.Controller position"),modelValue:e.remoteSelectPre.form.controllerFile,"onUpdate:modelValue":t[17]||(t[17]=r=>e.remoteSelectPre.form.controllerFile=r),placeholder:i(o)("crud.crud.Please select the controller of the data table"),key:"controller-file"+JSON.stringify(e.remoteSelectPre.controllerFileList),data:{content:e.remoteSelectPre.controllerFileList},attr:{"block-help":i(o)("crud.crud.The remote pull-down will request the corresponding controller to obtain data, so it is recommended that you create the CRUD of the associated table")}},null,8,["label","modelValue","placeholder","data","attr"])),(s(),h(F,{type:"select",label:i(o)("crud.crud.Data Model Location"),modelValue:e.remoteSelectPre.form.modelFile,"onUpdate:modelValue":t[18]||(t[18]=r=>e.remoteSelectPre.form.modelFile=r),placeholder:i(o)("crud.crud.Please select the data model location of the data table"),key:"model-file"+JSON.stringify(e.remoteSelectPre.modelFileList),data:{content:e.remoteSelectPre.modelFileList},attr:{"block-help":i(o)("crud.crud.If it is left blank, the model of the associated table will be generated automatically If the table already has a model, it is recommended to select it to avoid repeated generation")}},null,8,["label","modelValue","placeholder","data","attr"]))])),[[Y,e.loading.remoteSelect]])]),_:1},8,["model","rules"])),[[Y,e.remoteSelectPre.loading]])],4)]),_:1},8,["model-value","title","onKeyup"]),m(de,{onClose:$,class:"ba-operate-dialog confirm-generate-dialog","model-value":e.confirmGenerate.show,title:i(o)("crud.crud.Confirm CRUD code generation")},{footer:u(()=>[p("div",pt,[m(n,{onClick:$},{default:u(()=>[T(S(a.$t("Cancel")),1)]),_:1}),I((s(),h(n,{loading:e.loading.generate,onClick:re,type:"primary"},{default:u(()=>[T(S(i(o)("crud.crud.Continue building")),1)]),_:1},8,["loading"])),[[x]])])]),default:u(()=>[p("div",ut,[e.confirmGenerate.controller?(s(),h(me,{key:0,title:i(o)("crud.crud.The controller already exists Continuing to generate will automatically overwrite the existing code!"),center:"",type:"error"},null,8,["title"])):N("",!0),ft,e.confirmGenerate.table?(s(),h(me,{key:1,title:i(o)("crud.crud.The data table already exists Continuing to generate will automatically delete the original table and create a new one!"),center:"",type:"error"},null,8,["title"])):N("",!0)])]),_:1},8,["model-value","title"])])}}});const Ct=Me(gt,[["__scopeId","data-v-de5dcd78"]]);export{Ct as default};
