import{i as p,x as B,y as w,_ as I,z as V}from"./index-32d6febb.js";import{h as S,aa as T,r as z,j as f,o as s,k as l,m as i,U as h,z as u,a8 as F,Z as g,Y as y,V as $,$ as k,l as j,a1 as L,a2 as N,p as R,ab as D}from"./vue-69ad5a16.js";const x=o=>(L("data-v-a7a098aa"),o=o(),N(),o),E=["id"],U={key:0,class:"loading"},Y={key:1,class:"captcha-img-box"},M=["src","alt"],P=["onClick"],X={key:2,class:"captcha-prompt"},Z={key:3,class:"captcha-prompt"},q={class:"captcha-refresh-box"},A=x(()=>i("div",{class:"captcha-refresh-line captcha-refresh-line-l"},null,-1)),G=["title"],H=x(()=>i("div",{class:"captcha-refresh-line captcha-refresh-line-r"},null,-1)),J=S({__name:"index",props:{uuid:{default:""},callback:{type:Function,default:()=>{}},class:{default:""},unset:{type:Boolean,default:!1},error:{default:p.global.t("validate.The correct area is not clicked, please try again!")},success:{default:p.global.t("validate.Verification is successful!")}},setup(o){const e=o;T(t=>({"0aacbc72":C.value,"52eceb8a":v.value,"314b8f1b":a.captcha.width,"43514b1c":a.captcha.height}));const a=z({loading:!0,xy:[],tip:"",captcha:{id:"",text:"",base64:"",width:350,height:200}}),n=()=>{a.loading=!0,B(e.uuid).then(t=>{a.xy=[],a.tip="",a.loading=!1,a.captcha=t.data})},b=t=>{if(a.xy.length<a.captcha.text.length&&(a.xy.push(t.offsetX+","+t.offsetY),a.xy.length==a.captcha.text.length)){const r=[a.xy.join("-"),t.target.width,t.target.height].join(";");w(e.uuid,r,e.unset).then(()=>{a.tip=e.success,setTimeout(()=>{var c;(c=e.callback)==null||c.call(e,r),_()},1500)}).catch(()=>{a.tip=e.error,setTimeout(()=>{n()},1500)})}},m=t=>{a.xy.splice(t,1)},_=()=>{var t;(t=document.getElementById(e.uuid))==null||t.remove()},v=f(()=>(a.captcha.height+200)/2+"px"),C=f(()=>(a.captcha.width+24)/2+"px");return n(),(t,r)=>(s(),l("div",{id:t.uuid},[i("div",{class:k(["ba-click-captcha",e.class])},[a.loading?(s(),l("div",U,h(u(p).global.t("utils.Loading")),1)):(s(),l("div",Y,[i("img",{class:"captcha-img",onClick:r[0]||(r[0]=F(c=>b(c),["prevent"])),src:a.captcha.base64,alt:u(p).global.t("validate.Captcha loading failed, please click refresh button")},null,8,M),(s(!0),l(g,null,y(a.xy,(c,d)=>(s(),l("span",{key:d,class:"step",onClick:O=>m(d),style:j(`left:${parseFloat(c.split(",")[0])-13}px;top:${parseFloat(c.split(",")[1])-13}px`)},h(d+1),13,P))),128))])),a.tip?(s(),l("div",X,h(a.tip),1)):(s(),l("div",Z,[$(h(u(p).global.t("validate.Please click"))+" ",1),(s(!0),l(g,null,y(a.captcha.text,(c,d)=>(s(),l("span",{key:d,class:k(a.xy.length>d?"clicaptcha-clicked":"")},h(c),3))),128))])),i("div",q,[A,i("i",{class:"fa fa-refresh captcha-refresh-btn",title:u(p).global.t("Refresh"),onClick:n},null,8,G),H])],2),i("div",{class:"ba-layout-shade",onClick:_})],8,E))}});const K=I(J,[["__scopeId","data-v-a7a098aa"]]),aa=(o,e,a={})=>{let n=R(K,{uuid:o,callback:e,...a,key:V()});D(n,document.body),n=null};export{aa as c};
