import{D as K,_ as O}from"./darkSwitch-CNSoJAOO.js";import{i as W,f as V,p as _,X as Y,o,j as D,Y as q,Z as F,w as n,_ as M,O as i,P as a,W as I,V as b,U as f,m as h,$ as A,M as P,a0 as X,r as Q,C as Z,l as y,n as ee,a1 as ne,a2 as te}from"./vue-BMxP1YH6.js";import{d as oe,r as ae,b as G,u as B,a as T,c as se,s as re,_ as R,e as le,f as ie,g as ue}from"./index-HeYxHBW0.js";import{h as ce,o as H}from"./router-CX7BRVjm.js";import{t as de}from"./useDark-DBjpfraw.js";const me="/api/index/";function pe(v,g){oe(()=>{if(ae.currentRoute.value.meta.initialize===!1)return;const m=G(),u=B();if(!m.isLogin()&&u.initialize||m.isLogin()&&u.userInitialize)return;const s=T();se({url:me+"index",method:"get",params:{requiredLogin:g?1:0}}).then(l=>{ce(l.data.rules,l.data.menus),u.dataFill(l.data.site),s.setStatus(l.data.openMemberCenter),W(l.data.userInfo)||(l.data.userInfo.refresh_token=m.getToken("refresh"),m.dataFill(l.data.userInfo),u.setUserInitialize(!0)),l.data.openMemberCenter||s.setLayoutMode("Disable"),u.setInitialize(!0),re(),typeof v=="function"&&v(l)})},200)()}const fe=V({__name:"menuSub",props:{menus:{default:()=>[]},showIcon:{type:Boolean,default:!1}},setup(v){const g=v,m=u=>{var s;u.path=="/"||((s=u.meta)==null?void 0:s.type)=="menu_dir"||H(u)};return(u,s)=>{const l=_("Icon"),r=_("el-sub-menu"),N=_("el-menu-item"),w=Y("blur");return o(!0),D(F,null,q(g.menus,(p,U)=>{var z,$;return o(),D(F,{key:U},[n(W)(p.children)?M((o(),i(N,{key:1,onClick:c=>n(H)(p),index:"column-"+(($=p.meta)==null?void 0:$.id),class:A(p.name.replace(/[\/]/g,"-"))},{title:a(()=>{var c;return[b(f((c=p.meta)==null?void 0:c.title),1)]}),default:a(()=>{var c;return[u.showIcon?(o(),i(l,{key:0,name:(c=p.meta)==null?void 0:c.icon,color:"var(--el-text-color-primary)"},null,8,["name"])):I("",!0)]}),_:2},1032,["onClick","index","class"])),[[w]]):M((o(),i(r,{key:0,onClick:c=>m(p),index:`column-${(z=p.meta)==null?void 0:z.id}`},{title:a(()=>{var c,e;return[u.showIcon?(o(),i(l,{key:0,name:(c=p.meta)==null?void 0:c.icon,color:"var(--el-text-color-primary)"},null,8,["name"])):I("",!0),b(" "+f((e=p.meta)==null?void 0:e.title),1)]}),default:a(()=>[h(E,{menus:p.children,"show-icon":u.showIcon},null,8,["menus","show-icon"])]),_:2},1032,["onClick","index"])),[[w]])],64)}),128)}}}),E=R(fe,[["__scopeId","data-v-0badd86c"]]),he={class:"header-user-box"},_e=["src"],ve=V({__name:"menu",props:{showIcon:{type:Boolean,default:!1}},setup(v){const g=P(),m=X(),u=le(),s=G(),l=B(),r=T(),N=v,w=Q({activeMenu:""}),p=e=>{var t,k;for(const d in r.state.navUserMenus)if(r.state.navUserMenus[d].path==e.path||r.state.navUserMenus[d].name==e.name)return(t=r.state.navUserMenus[d].meta)==null?void 0:t.id;for(const d in l.headNav)if(l.headNav[d].path==e.path||l.headNav[d].name==e.name)return(k=l.headNav[d].meta)==null?void 0:k.id},U=e=>{if(e.path=="/")return w.activeMenu="index";const t=p(e);t?w.activeMenu="column-"+t:e.path.startsWith("/user")&&(w.activeMenu="user")};U(g);const z=e=>{if($(l.headNav,e)||$(r.state.navUserMenus,e)){const t=w.activeMenu;w.activeMenu="",ee(()=>{w.activeMenu=t})}},$=(e,t)=>t.indexOf("language-switch")===0||t=="theme-switch"?!0:c(e,t),c=(e,t)=>{var k,d,L;for(const S in e){if(`column-${(k=e[S].meta)==null?void 0:k.id}`==t)return((d=e[S].meta)==null?void 0:d.menu_type)=="link";if((L=e[S].children)!=null&&L.length)return c(e[S].children,t)}return!1};return Z(()=>g.path,()=>{U(g)}),(e,t)=>{const k=_("Icon"),d=_("el-menu-item"),L=_("el-sub-menu"),S=_("el-menu"),x=Y("blur");return o(),i(S,{"default-active":w.activeMenu,onSelect:z},{default:a(()=>[M((o(),i(d,{onClick:t[0]||(t[0]=C=>n(m).push({name:"/"})),index:"index"},{title:a(()=>[b(f(e.$t("Home")),1)]),default:a(()=>[N.showIcon?(o(),i(k,{key:0,name:"fa fa-home",color:"var(--el-text-color-primary)"})):I("",!0)]),_:1})),[[x]]),h(E,{menus:n(l).headNav,"show-icon":e.showIcon},null,8,["menus","show-icon"]),n(r).state.open?(o(),D(F,{key:0},[n(s).isLogin()?M((o(),i(L,{key:0,onClick:t[3]||(t[3]=C=>e.$attrs.mode=="vertical"?"":n(m).push({name:"user"})),index:"user-box"},{title:a(()=>[y("div",he,[y("img",{class:A(["header-user-avatar",e.$attrs.mode=="vertical"?"icon-header-user-avatar":""]),src:n(ie)(n(s).avatar?n(s).avatar:"/static/images/avatar.png"),alt:""},null,10,_e),b(" "+f(n(s).nickname),1)])]),default:a(()=>[M((o(),i(d,{onClick:t[1]||(t[1]=C=>n(m).push({name:"user"})),index:"user"},{default:a(()=>[e.showIcon?(o(),i(k,{key:0,name:"fa fa-user-circle",color:"var(--el-text-color-primary)"})):I("",!0),b(" "+f(e.$t("Member Center")),1)]),_:1})),[[x]]),h(E,{menus:n(r).state.navUserMenus,"show-icon":e.showIcon},null,8,["menus","show-icon"]),h(E,{menus:n(r).state.viewRoutes,"show-icon":e.showIcon},null,8,["menus","show-icon"]),M((o(),i(d,{onClick:t[2]||(t[2]=C=>n(s).logout()),index:"user-logout"},{default:a(()=>[e.showIcon?(o(),i(k,{key:0,name:"fa fa-sign-out",color:"var(--el-text-color-primary)"})):I("",!0),b(" "+f(e.$t("Logout login")),1)]),_:1})),[[x]])]),_:1})),[[x]]):M((o(),i(d,{key:1,onClick:t[4]||(t[4]=C=>n(m).push({name:"user"})),index:"user"},{default:a(()=>[e.showIcon?(o(),i(k,{key:0,name:"fa fa-user-circle",color:"var(--el-text-color-primary)"})):I("",!0),b(" "+f(e.$t("Member Center")),1)]),_:1})),[[x]]),M((o(),i(L,{index:"language-switch",class:"language-switch"},{title:a(()=>[e.showIcon?(o(),i(k,{key:0,name:"local-lang",color:"var(--el-text-color-primary)"})):I("",!0),b(" "+f(e.$t("Language")),1)]),default:a(()=>[(o(!0),D(F,null,q(n(u).lang.langArray,C=>(o(),i(d,{onClick:$e=>n(ue)(C.name),key:C.name,index:"language-switch-"+C.value,class:"language-switch"},{default:a(()=>[e.showIcon?(o(),i(k,{key:0,name:"fa fa-circle-o",color:"var(--el-text-color-primary)"})):I("",!0),b(" "+f(C.value),1)]),_:2},1032,["onClick","index"]))),128))]),_:1})),[[x]]),h(d,{index:"theme-switch",class:A(["theme-switch",e.$attrs.mode+"-theme-switch"])},{default:a(()=>[h(K,{onClick:t[5]||(t[5]=C=>n(de)())})]),_:1},8,["class"])],64)):I("",!0)]),_:1},8,["default-active"])}}}),j=R(ve,[["__scopeId","data-v-1bc2cccf"]]),J=v=>(ne("data-v-d2397cc9"),v=v(),te(),v),ge=J(()=>y("img",{src:O},null,-1)),we={class:"site-name"},ke={class:"header-row"},ye=J(()=>y("img",{src:O},null,-1)),Ce={class:"site-name"},Ie=V({__name:"header",setup(v){const g=P(),m=X(),u=B(),s=T();return Z(()=>g.path,()=>{s.toggleMenuExpand(!1)},{immediate:!0}),pe(),(l,r)=>{const N=_("Icon"),w=_("el-scrollbar"),p=_("el-col"),U=_("el-row"),z=_("el-drawer"),$=_("el-header");return o(),i($,{class:"header"},{default:a(()=>[h(U,{justify:"center"},{default:a(()=>[h(p,{class:"header-row",xs:24,sm:24,md:16},{default:a(()=>[y("div",{onClick:r[0]||(r[0]=c=>n(m).push({name:"/"})),class:"header-logo"},[ge,y("span",we,f(n(u).siteName),1)]),n(s).state.menuExpand?I("",!0):(o(),D("div",{key:0,onClick:r[1]||(r[1]=c=>n(s).toggleMenuExpand(!0)),class:"user-menus-expand hidden-md-and-up"},[h(N,{name:"fa fa-indent",color:"var(--el-color-primary)",size:"20"})])),h(w,{class:"hidden-sm-and-down"},{default:a(()=>[h(j,{class:"frontend-header-menu",ellipsis:!1,mode:"horizontal"})]),_:1})]),_:1})]),_:1}),h(z,{class:"ba-aside-drawer","append-to-body":!0,modelValue:n(s).state.menuExpand,"onUpdate:modelValue":r[4]||(r[4]=c=>n(s).state.menuExpand=c),"with-header":!1,direction:"ltr",size:"40%"},{default:a(()=>[y("div",ke,[y("div",{onClick:r[2]||(r[2]=c=>n(m).push({name:"/"})),class:"header-logo"},[ye,y("span",Ce,f(n(u).siteName),1)]),y("div",{onClick:r[3]||(r[3]=c=>n(s).toggleMenuExpand(!1)),class:"user-menus-expand hidden-md-and-up"},[h(N,{name:"fa fa-dedent",color:"var(--el-color-primary)",size:"20"})])]),h(j,{"show-icon":!0,mode:"vertical"})]),_:1},8,["modelValue"])]),_:1})}}}),Le=R(Ie,[["__scopeId","data-v-d2397cc9"]]),be={href:"http://beian.miit.gov.cn/"},Me=V({__name:"footer",setup(v){const g=B();return(m,u)=>{const s=_("el-footer");return o(),i(s,{class:"footer"},{default:a(()=>[y("div",null,[b(" Copyright @ 2020~"+f(new Date().getFullYear())+" "+f(n(g).siteName)+" "+f(m.$t("Copyright"))+" ",1),y("a",be,f(n(g).recordNumber),1)])]),_:1})}}}),De=R(Me,[["__scopeId","data-v-ff7303bf"]]);export{De as F,Le as H,pe as i};
