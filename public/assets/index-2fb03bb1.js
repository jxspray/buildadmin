import{h as j,w as K,r as $,E as M,F as w,q as i,o as r,k,p as a,P as n,V as m,Z as U,Y as N,O as f,m as b,U as P,a8 as z,z as R,aA as W,a9 as Y,W as Z}from"./vue-69ad5a16.js";import{w as G,_ as H}from"./index-32d6febb.js";import{b as x}from"./validate-4db1e214.js";import{B as Q}from"./index-afbe03c0.js";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang-fce1224c.js";import"./index-f98c8d12.js";const ee={class:"el-array",ref:"elArray"},le={class:"el-array-title"},te=["onClick"],oe=["onClick"],ae={slot:"footer",class:"dialog-footer"},ne=j({__name:"index",props:{modelValue:{default:()=>[]}},emits:["update:modelValue"],setup(B,{emit:h}){const S=B,{t:_}=G(),y=K(),e=$({value:S.modelValue,column:[],table:[],dialog:!1,fieldForm:{label:"",field:"",type:{}},fieldList:[{label:"文本",type:"string",width:"200px",value:""},{label:"文本域",type:"textarea",width:"300px",value:""},{label:"编辑器",type:"editor",width:"700px",value:""},{label:"图片上传",type:"image",width:"344px",value:""},{label:"文件上传",type:"file",width:"344px",value:""},{label:"链接",type:"link-select",width:"300px",value:{}}]}),E=()=>{let o={};e.column.forEach(function(l,d){o[l.field]=l.type.value}),console.log(o),e.table.unshift(o)},F=(o=void 0)=>{if(o)o.validate(l=>{if(l){let d=JSON.parse(JSON.stringify(e.fieldForm));e.column.push(d),e.table.map(u=>(u[d.field]=d.type.value,u)),e.dialog=!1,e.fieldForm={}}});else return!1},I=o=>{let l=e.column[o].field;e.column.splice(o,1),e.table.forEach(function(d,u){this.$delete(d,l)})},g=(o="")=>{let l={};e.column.forEach(function(d,u){l[d.field]=d.type.value}),o===""?e.table.push(l):e.table.splice(o+1,0,l)},O=o=>{e.table.splice(o,1)};M(()=>{let o=JSON.stringify(e.value)=="{}"||e.value=="";e.table=o?[]:e.value.table,e.column=o?[{label:"标题",field:"title",type:{label:"文本",type:"string",width:"300px",value:""}}]:e.value.column}),w(()=>e.value,o=>{let l=JSON.stringify(o)=="{}"||o=="";e.table=l?[]:o.table,e.column=l?[{label:"标题",field:"title",type:{label:"文本",is:"el-input",value:""}}]:o.column}),w(()=>e.column,o=>{h("update:modelValue",{column:e.column,table:e.table})}),w(()=>e.table,o=>{h("update:modelValue",{column:e.column,table:e.table})});const q=$({label:[x({name:"required",title:_("字段标题")})],field:[x({name:"required",title:_("字段变量")})],type:[x({name:"required",title:_("字段类型")})]});return(o,l)=>{const d=i("el-button"),u=i("el-tooltip"),J=i("Icon"),C=i("el-table-column"),T=i("el-table"),A=i("el-option"),D=i("el-select"),c=i("el-form-item"),v=i("el-input"),L=i("el-dialog");return r(),k("div",ee,[a(d,{type:"primary",onClick:l[0]||(l[0]=t=>E()),size:"small"},{default:n(()=>[m("新增一行")]),_:1}),a(T,{data:e.table,"row-key":"id",border:""},{default:n(()=>[(r(!0),k(U,null,N(e.column,(t,s)=>(r(),f(C,{prop:t.field,key:s,width:t.type.width},{header:n(()=>[a(u,{content:t.field,placement:"top"},{default:n(()=>[b("span",le,P(t.label),1)]),_:2},1032,["content"]),a(u,{content:"删除字段",placement:"top"},{default:n(()=>[a(J,{name:"el-icon-Delete",class:"el-array-remove",color:"var(--el-color-error)",onClick:p=>I(s)},null,8,["onClick"])]),_:2},1024)]),default:n(p=>[t.type.type=="link-select"?(r(),f(X,{key:0,modelValue:p.row[t.field],"onUpdate:modelValue":V=>p.row[t.field]=V,size:""},null,8,["modelValue","onUpdate:modelValue"])):(r(),f(Q,{key:1,onPointerdown:l[1]||(l[1]=z(()=>{},["stop"])),modelValue:p.row[t.field],"onUpdate:modelValue":V=>p.row[t.field]=V,type:t.type.type},null,8,["modelValue","onUpdate:modelValue","type"]))]),_:2},1032,["prop","width"]))),128)),a(C,null,{header:n(()=>[a(d,{type:"primary",onClick:l[2]||(l[2]=t=>e.dialog=!0),size:"small"},{default:n(()=>[m("新增字段")]),_:1})]),default:n(t=>[b("a",{href:"javascript:",onClick:s=>O(t.$index)},"删除",8,te),b("a",{href:"javascript:",onClick:s=>g(t.$index)},"追加",8,oe)]),_:1})]),_:1},8,["data"]),a(d,{type:"primary",onClick:l[3]||(l[3]=t=>g()),size:"small"},{default:n(()=>[m("新增一行")]),_:1}),a(L,{top:"20px",title:"列表新增字段","model-value":e.dialog,"close-on-click-modal":!1,width:"500px","append-to-body":""},{default:n(()=>[a(R(W),{model:e.fieldForm,rules:q,ref_key:"fieldFormRef",ref:y,onKeyup:l[8]||(l[8]=Y(t=>F(y.value),["enter"])),"label-width":"100px",onSubmit:l[9]||(l[9]=z(()=>{},["prevent"]))},{default:n(()=>[a(c,{label:"字段类型：",prop:"type"},{default:n(()=>[a(D,{style:{width:"100%"},modelValue:e.fieldForm.type,"onUpdate:modelValue":l[4]||(l[4]=t=>e.fieldForm.type=t),"value-key":"label",placeholder:"请选择字段类型",filterable:""},{default:n(()=>[(r(!0),k(U,null,N(e.fieldList,(t,s)=>(r(),f(A,{key:s,label:t.label,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(c,{label:"字段标题：",prop:"label"},{default:n(()=>[a(v,{modelValue:e.fieldForm.label,"onUpdate:modelValue":l[5]||(l[5]=t=>e.fieldForm.label=t),placeholder:"如：内容"},null,8,["modelValue"])]),_:1}),a(c,{label:"字段变量：",prop:"field"},{default:n(()=>[a(v,{modelValue:e.fieldForm.field,"onUpdate:modelValue":l[6]||(l[6]=t=>e.fieldForm.field=t),placeholder:"如：content"},null,8,["modelValue"])]),_:1}),e.fieldForm.type?(r(),f(c,{key:0,label:"字段宽度：",prop:"width"},{default:n(()=>[a(v,{modelValue:e.fieldForm.type.width,"onUpdate:modelValue":l[7]||(l[7]=t=>e.fieldForm.type.width=t),placeholder:"如：500px"},null,8,["modelValue"])]),_:1})):Z("",!0)]),_:1},8,["model","rules"]),b("span",ae,[a(d,{size:"small",type:"primary",onClick:l[10]||(l[10]=t=>F(y.value))},{default:n(()=>[m("确 定")]),_:1}),a(d,{size:"small",onClick:l[11]||(l[11]=t=>e.dialog=!1)},{default:n(()=>[m("取 消")]),_:1})])]),_:1},8,["model-value"])],512)}}});const me=H(ne,[["__scopeId","data-v-70382d2d"]]);export{me as default};
